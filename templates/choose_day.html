{% extends 'base.html' %}
{% block content %}

<h1>Add a Training Day</h1>

<form id="day-selection-form" action='/choose_training_day' method="POST">
    <input type="date" id="start" name="workout-date" min="2019-01-01" max="2019-12-31">
    description: <input type="text" name="description" id="memo">
    <input type="submit" name="submit">
</form>

<script>
    $(function() {    
        $('#day-selection-form').on('submit', evt => {
            evt.preventDefault();

            const formData = {
                "workout-date": $('#start').val(),
                "description": $('#memo').val()
            };
            console.log(formData);
            $.post('/choose_training_day', formData);
            $('.exercise-form').css({ display: 'block' });

        //     const equipList = ['Barbell', 'Bench', 'Dumbbell', 'Gym mat','Incline bench', 'Kettlebell' , 'none (bodyweight exercise)', 'Pull-up bar', 'Swiss Ball', 'SZ-Bar'];
        //     const categoryList = ['Abs', 'Arms', 'Back', 'Calves','Chest', 'Legs','Shoulders']
        //     const $equpInputs = equipList.map((equip) => {
        //         const $input = $('<input>', { type:'checkbox',
        //                                     name:'equipment',
        //                                     value:equip,
        //                                     class:'equipment_checkboxes',
        //                                     html:equip
        //                                 });
        //         return $equpInputs;
        //     });
        //     const $categoryInputs = categoryList.map((category) => {
        //         const $input = $('<input>', { type:'checkbox',
        //                                     name:'category',
        //                                     value:category,
        //                                     class:'category_checkboxes',
        //                                     html:category
        //                                 });
        //         return $categoryInputs;
        //     });

        //     const headerInputList = ['Equipment:', 'Category:']
        //     const $headerInputs = headerInputList.map((header) => {
        //         const $input = $('<h2>', {
        //             html:header
        //         });

        //         return $headerInputs
        //     });

        //     const $form = $('<form>', {id:'exercise-form',
        //                                 action:'/choose_training_day',
        //                                 method:'GET'
        //                             });
        //     $form.append($headerInuts)
        //     $headerInuts.append($equpInputs)
        });
    });
</script>

<div class="exercise-form">
<h1>Workout Search</h1>
<form id="exercise-form" action="/choose_training_day" method="GET">
    <h2>Equipment:</h2>
    <input type="checkbox" name="equipment" value="Barbell" class="equipment_checkboxes">Barbell
    <input type="checkbox" name="equipment" value="Bench" class="equipment_checkboxes">Bench
    <input type="checkbox" name="equipment" value="Dumbbell" class="equipment_checkboxes">Dumbbell
    <input type="checkbox" name="equipment" value="Gym mat" class="equipment_checkboxes">Gym mat
    <input type="checkbox" name="equipment" value="Incline bench" class="equipment_checkboxes">Incline bench
    <input type="checkbox" name="equipment" value="Kettlebell" class="equipment_checkboxes">Kettlebell
    <input type="checkbox" name="equipment" value="none (bodyweight exercise)" class="equipment_checkboxes">none (bodyweight exercise)
    <input type="checkbox" name="equipment" value="Pull-up bar" class="equipment_checkboxes">Pull-up bar
    <input type="checkbox" name="equipment" value="Swiss Ball" class="equipment_checkboxes">Swiss Ball
    <input type="checkbox" name="equipment" value="SZ-Bar" class="equipment_checkboxes">SZ-Bar

    <h2>Body Parts:</h2>
    <input type="checkbox" name="category" value="Abs" class="category_checkboxes">Abs
    <input type="checkbox" name="category" value="Arms" class="category_checkboxes">Arms
    <input type="checkbox" name="category" value="Back" class="category_checkboxes">Back
    <input type="checkbox" name="category" value="Calves" class="category_checkboxes">Calves
    <input type="checkbox" name="category" value="Chest" class="category_checkboxes">Chest
    <input type="checkbox" name="category" value="Legs" class="category_checkboxes">Legs
    <input type="checkbox" name="category" value="Shoulders" class="category_checkboxes">Shoulders

    <div>
    <br>
    <input id="exercise_submit" type="submit" name="submit">
    </div>
</form>
</div>

<div id="exercise_result">
</div>

<div class="detail-form">
    <form id="detail-form" action="/addexercises" method="POST">
    <p>
        <br>
        <label> Select set number</label>
        <select name="numberofsets" id="set">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
        </select>
        <br>
        <label> Enter reps for each set</label>
        <input type="text" name="reps" id="rep" required>
        <select name="repunit" id="repunit">
            <option value="Kilometers">Kilometers</option>
            <option value="Miles">Miles</option>
            <option value="Minutes">Minutes</option>
            <option value="Repetitions">Repetitions</option>
            <option value="Seconds">Seconds</option>
            <option value="Until Failure">Until Failure</option>
        </select>

        <br>
        <label> Enter weights for each rep</label>
        <input type="text" name="weights" id="weights">
        <select name="weightunit" id="weightunit">
            <option value="Body Weight">Body Weight</option>
            <option value="kg">kg</option>
            <option value="Kilometers Per Hour">Kilometers Per Hour</option>
            <option value="lb">lb</option>
            <option value="Miles Per Hour">Miles Per Hour</option>
            <option value="Plates">Plates</option>
        </select>

    </p>
    <div>
        <!-- <a href="/search/{}"> --><input type="submit" name="submit">
    </div>

</form>
<div>
<a href="/dashboard">Go to Dashboard
</div>

<script>
    $(function() {    
        $('#exercise-form').on('submit', evt => {
            evt.preventDefault();

            const formData = {
                equipment: $('.equipment_checkboxes:checked').val(),
                category: $('.category_checkboxes:checked').val()
            };
            console.log(formData);
             
            $.get('/choose_exercises.json', formData, (results) => {
                const exercise = results;
                var list_html = "<br>"
                list_html += "Results:"
                list_html += "<ul>";
                for (var i = 0; i < exercise.length; i++) {
                    var obj = exercise[i];
                    list_html += "<li>" + "<a class='detail' data-id=" + obj.exercise_id + ">" + obj.name + "</li>";
                }
                list_html += "</ul>"
                $('#exercise_result').html(list_html);
            });
        });
    });
</script>

<script>
    $(function() {
        $('#exercise_result').on('click', function(evt) {
            evt.preventDefault();

            const $evt = $(evt.target);
            const id = $evt.data('id');
            const url = '/addexercises/' + id;
            console.log("id: ", id);

            $.get('/search/' + id, id);
            // $('.detail-form').attr('action', url);
            $('.detail-form').toggle();
        });
    });
</script>
<script>
    $(function() {
        $('.detail-form').on('submit', function(evt) {
            evt.preventDefault();


            const formData = {
                numberofsets: $('#set').val(),
                reps: $('#rep').val(),
                repunit: $('#repunit').val(),
                weights: $('#weights').val(),
                weightunit: $('#weightunit').val()
            };
            console.log(formData);
            $.post('/addexercises', formData)

        });
    });
</script>

<script>
    $(function(){
        $('.done').on('click',function(){
            location.href = '/addexercises'
        });
    });
</script>
<!-- 
 <script type="text/javascript">
     console.log("hi");
 </script>
 -->
{% endblock %}